<%
  @delivered_duty = @order.flow_order ? @order.flow_order.delivered_duty : 'paid'
%>

<br />

<h5 class="stock-shipping-method-title" style="text-align: left;">Edit duties and tax preferences</h5>

<div id="popup-bg"></div>
<div id="popup">
  <h2>Duties & Taxes</h2>

  <p>Please choose whether you would like to include the duties & taxes in the order payment.</p>

  <label class="checkbox-block" onclick="Popup.select('paid');">
    <input type="radio" name="flow_delivered_duty" value="paid" <%= @delivered_duty == 'paid' ? 'checked="true"'.html_safe : '' %> />
    <p class="title">Paid</p>
    <p>You will pay duties & taxes with your order.</p>
  </label>

  <label class="checkbox-block" onclick="Popup.select('unpaid');">
    <input type="radio" name="flow_delivered_duty" value="unpaid" <%= @delivered_duty == 'unpaid' ? 'checked="true"'.html_safe : '' %> />
    <p class="title">Unpaid</p>
    <p>
      You will not pay duties and taxes with your order now but will have to pay them,
      if applicable, with your ship-to countryâ€™s customs agency when you pick up your order.
    </p>
  </label>

  <hr />

  <button class="btn btn-default" onclick="Popup.close(); return false;">Cancel</button>
</div>

<p id="select-paid" onclick="Popup.select('paid')"><b>Duties & Taxes Paid:</b> You will pay duties & taxes with your order, if applicable.</p>
<p id="select-unpaid" onclick="Popup.select('unpaid')" style="display: none;"><b>Duties & Taxes Unpaid:</b> You will not pay duties & taxes with your order. Your items might be subject to duties and/or taxes by your local customs authority.</p>

<button class="button primary" onclick="Popup.open(); return false;">Edit Duties & Taxes Preference</button>

<style>
#popup-bg {
  display: none;
  position: fixed; background-color: rgba(222, 222, 222, 0.7); top: 0; left:0; width: 100%; height: 100%;
}
#popup {
  display: none;
  position: fixed; background-color: #fff; width: 600px; top: 50px; left: 50%; margin-left: -300px;
  padding: 20px;
}
#popup label:hover { background-color: #eee; }
#popup label.checkbox-block { display: block; padding: 10px 10px 0 60px; border: 1px solid #ccc; position: relative; cursor: pointer; }
#popup label.checkbox-block input { position: absolute; margin-left: -20px; margin-top: 10px; zoom: 2; }
#popup p.title { font-weight: bold; }
</style>

<script>
  Popup = {}
  Popup.open   = function() { $('#popup, #popup-bg').show(); }
  Popup.close  = function() { $('#popup, #popup-bg').hide(); }
  Popup.select = function(value) {
    Popup.close();
    $('#select-paid, #select-unpaid').hide();
    $('#select-' + value).show();
   }
</script>